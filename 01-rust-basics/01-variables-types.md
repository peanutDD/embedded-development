# å˜é‡ä¸æ•°æ®ç±»å‹

## æ¦‚è¿°

Rustæ˜¯ä¸€é—¨é™æ€ç±»å‹è¯­è¨€ï¼Œè¿™æ„å‘³ç€æ‰€æœ‰å˜é‡çš„ç±»å‹åœ¨ç¼–è¯‘æ—¶éƒ½å¿…é¡»ç¡®å®šã€‚æœ¬ç« å°†ä»‹ç»Rustçš„å˜é‡ç³»ç»Ÿå’Œç±»å‹ç³»ç»Ÿï¼Œè¿™æ˜¯ç†è§£Rustè¯­è¨€çš„åŸºç¡€ã€‚

## å˜é‡å£°æ˜

### ä¸å¯å˜å˜é‡ï¼ˆé»˜è®¤ï¼‰

åœ¨Rustä¸­ï¼Œå˜é‡é»˜è®¤æ˜¯ä¸å¯å˜çš„ï¼ˆimmutableï¼‰ï¼š

```rust
fn main() {
    let x = 5;
    println!("xçš„å€¼æ˜¯: {}", x);
    
    // ä¸‹é¢è¿™è¡Œä¼šç¼–è¯‘é”™è¯¯
    // x = 6; // é”™è¯¯ï¼šcannot assign twice to immutable variable
}
```

### å¯å˜å˜é‡

ä½¿ç”¨`mut`å…³é”®å­—å£°æ˜å¯å˜å˜é‡ï¼š

```rust
fn main() {
    let mut x = 5;
    println!("xçš„å€¼æ˜¯: {}", x);
    
    x = 6; // æ­£ç¡®ï¼šå¯å˜å˜é‡å¯ä»¥é‡æ–°èµ‹å€¼
    println!("xçš„æ–°å€¼æ˜¯: {}", x);
}
```

### å˜é‡é®è”½ï¼ˆShadowingï¼‰

å¯ä»¥å£°æ˜ä¸ä¹‹å‰å˜é‡åŒåçš„æ–°å˜é‡ï¼š

```rust
fn main() {
    let x = 5;
    let x = x + 1; // é®è”½ä¹‹å‰çš„x
    let x = x * 2;  // å†æ¬¡é®è”½
    
    println!("xçš„å€¼æ˜¯: {}", x); // è¾“å‡º: 12
    
    // é®è”½è¿˜å¯ä»¥æ”¹å˜ç±»å‹
    let spaces = "   ";
    let spaces = spaces.len(); // ä»å­—ç¬¦ä¸²å˜ä¸ºæ•°å­—
}
```

## åŸºæœ¬æ•°æ®ç±»å‹

### æ•´æ•°ç±»å‹

Rustæä¾›äº†å¤šç§æ•´æ•°ç±»å‹ï¼š

| é•¿åº¦ | æœ‰ç¬¦å· | æ— ç¬¦å· |
|------|--------|--------|
| 8ä½  | i8     | u8     |
| 16ä½ | i16    | u16    |
| 32ä½ | i32    | u32    |
| 64ä½ | i64    | u64    |
| 128ä½| i128   | u128   |
| arch | isize  | usize  |

```rust
fn main() {
    // ä¸åŒçš„æ•´æ•°ç±»å‹
    let a: i8 = -128;
    let b: u8 = 255;
    let c: i32 = -2_147_483_648;
    let d: u32 = 4_294_967_295;
    
    // æ•°å­—å­—é¢é‡
    let decimal = 98_222;        // åè¿›åˆ¶
    let hex = 0xff;              // åå…­è¿›åˆ¶
    let octal = 0o77;            // å…«è¿›åˆ¶
    let binary = 0b1111_0000;    // äºŒè¿›åˆ¶
    let byte = b'A';             // å­—èŠ‚ï¼ˆä»…é™u8ï¼‰
    
    println!("å„ç§æ•´æ•°: {}, {}, {}, {}", a, b, c, d);
    println!("å­—é¢é‡: {}, {}, {}, {}, {}", decimal, hex, octal, binary, byte);
}
```

### æµ®ç‚¹ç±»å‹

Rustæœ‰ä¸¤ç§æµ®ç‚¹ç±»å‹ï¼š

```rust
fn main() {
    let x = 2.0;      // f64ï¼ˆé»˜è®¤ï¼‰
    let y: f32 = 3.0; // f32
    
    println!("æµ®ç‚¹æ•°: {}, {}", x, y);
}
```

### å¸ƒå°”ç±»å‹

```rust
fn main() {
    let t = true;
    let f: bool = false;
    
    println!("å¸ƒå°”å€¼: {}, {}", t, f);
}
```

### å­—ç¬¦ç±»å‹

```rust
fn main() {
    let c = 'z';
    let z = 'â„¤';
    let heart_eyed_cat = 'ğŸ˜»';
    
    println!("å­—ç¬¦: {}, {}, {}", c, z, heart_eyed_cat);
}
```

## å¤åˆæ•°æ®ç±»å‹

### å…ƒç»„ï¼ˆTupleï¼‰

å…ƒç»„å¯ä»¥åŒ…å«ä¸åŒç±»å‹çš„å€¼ï¼š

```rust
fn main() {
    let tup: (i32, f64, u8) = (500, 6.4, 1);
    
    // è§£æ„å…ƒç»„
    let (x, y, z) = tup;
    println!("è§£æ„åçš„å€¼: {}, {}, {}", x, y, z);
    
    // é€šè¿‡ç´¢å¼•è®¿é—®
    let five_hundred = tup.0;
    let six_point_four = tup.1;
    let one = tup.2;
    
    println!("ç´¢å¼•è®¿é—®: {}, {}, {}", five_hundred, six_point_four, one);
}
```

### æ•°ç»„ï¼ˆArrayï¼‰

æ•°ç»„ä¸­çš„æ‰€æœ‰å…ƒç´ å¿…é¡»æ˜¯ç›¸åŒç±»å‹ï¼š

```rust
fn main() {
    let a = [1, 2, 3, 4, 5];
    let months = ["January", "February", "March", "April", "May", "June",
                  "July", "August", "September", "October", "November", "December"];
    
    // æŒ‡å®šç±»å‹å’Œé•¿åº¦
    let a: [i32; 5] = [1, 2, 3, 4, 5];
    
    // åˆå§‹åŒ–ç›¸åŒå€¼çš„æ•°ç»„
    let a = [3; 5]; // ç­‰åŒäº [3, 3, 3, 3, 3]
    
    // è®¿é—®æ•°ç»„å…ƒç´ 
    let first = a[0];
    let second = a[1];
    
    println!("æ•°ç»„å…ƒç´ : {}, {}", first, second);
    println!("æ•°ç»„é•¿åº¦: {}", a.len());
}
```

## ç±»å‹æ¨æ–­å’Œç±»å‹æ³¨è§£

### ç±»å‹æ¨æ–­

Rustç¼–è¯‘å™¨é€šå¸¸å¯ä»¥æ¨æ–­å˜é‡çš„ç±»å‹ï¼š

```rust
fn main() {
    let x = 42;        // æ¨æ–­ä¸ºi32
    let y = 3.14;      // æ¨æ–­ä¸ºf64
    let z = "hello";   // æ¨æ–­ä¸º&str
    
    println!("{}, {}, {}", x, y, z);
}
```

### æ˜¾å¼ç±»å‹æ³¨è§£

æœ‰æ—¶éœ€è¦æ˜¾å¼æŒ‡å®šç±»å‹ï¼š

```rust
fn main() {
    let guess: u32 = "42".parse().expect("ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼");
    
    // æˆ–è€…ä½¿ç”¨turbofishè¯­æ³•
    let guess = "42".parse::<u32>().expect("ä¸æ˜¯ä¸€ä¸ªæ•°å­—ï¼");
    
    println!("çŒœæµ‹çš„æ•°å­—: {}", guess);
}
```

## å¸¸é‡

å¸¸é‡ä½¿ç”¨`const`å…³é”®å­—å£°æ˜ï¼Œå¿…é¡»æŒ‡å®šç±»å‹ï¼š

```rust
const THREE_HOURS_IN_SECONDS: u32 = 60 * 60 * 3;

fn main() {
    println!("ä¸‰å°æ—¶çš„ç§’æ•°: {}", THREE_HOURS_IN_SECONDS);
}
```

## åµŒå…¥å¼å¼€å‘ä¸­çš„ç±»å‹é€‰æ‹©

åœ¨åµŒå…¥å¼å¼€å‘ä¸­ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®ç±»å‹éå¸¸é‡è¦ï¼š

```rust
// åµŒå…¥å¼å¼€å‘ä¸­çš„ç±»å‹é€‰æ‹©ç¤ºä¾‹
fn embedded_types_example() {
    // å¯„å­˜å™¨åœ°å€é€šå¸¸ä½¿ç”¨usizeæˆ–ç‰¹å®šçš„æŒ‡é’ˆç±»å‹
    let register_addr: usize = 0x4000_0000;
    
    // GPIOå¼•è„šç¼–å·é€šå¸¸ä½¿ç”¨u8å°±è¶³å¤Ÿ
    let pin_number: u8 = 13;
    
    // ä¼ æ„Ÿå™¨è¯»æ•°å¯èƒ½éœ€è¦ç‰¹å®šç²¾åº¦
    let temperature: f32 = 25.6;
    
    // çŠ¶æ€æ ‡å¿—ä½¿ç”¨bool
    let is_sensor_ready: bool = true;
    
    // æ—¶é—´æˆ³å¯èƒ½éœ€è¦u64
    let timestamp: u64 = 1234567890;
    
    println!("å¯„å­˜å™¨åœ°å€: 0x{:X}", register_addr);
    println!("å¼•è„šå·: {}", pin_number);
    println!("æ¸©åº¦: {}Â°C", temperature);
    println!("ä¼ æ„Ÿå™¨å°±ç»ª: {}", is_sensor_ready);
    println!("æ—¶é—´æˆ³: {}", timestamp);
}
```

## ç±»å‹è½¬æ¢

### æ˜¾å¼è½¬æ¢ï¼ˆaså…³é”®å­—ï¼‰

```rust
fn main() {
    let a = 13u8;
    let b = 7u32;
    let c = a as u32 + b;
    
    println!("è½¬æ¢ç»“æœ: {}", c);
    
    // æµ®ç‚¹æ•°è½¬æ•´æ•°ï¼ˆä¼šæˆªæ–­ï¼‰
    let f = 3.99;
    let i = f as i32;
    println!("æµ®ç‚¹è½¬æ•´æ•°: {} -> {}", f, i);
}
```

### Fromå’ŒIntoç‰¹å¾

```rust
fn main() {
    // Fromç‰¹å¾
    let s = String::from("hello");
    
    // Intoç‰¹å¾ï¼ˆé€šå¸¸ç”±Fromè‡ªåŠ¨å®ç°ï¼‰
    let s: String = "hello".into();
    
    println!("å­—ç¬¦ä¸²: {}", s);
}
```

## å®è·µç»ƒä¹ 

### ç»ƒä¹ 1ï¼šæ¸©åº¦è½¬æ¢å™¨

åˆ›å»ºä¸€ä¸ªç¨‹åºï¼Œå°†æ‘„æ°åº¦è½¬æ¢ä¸ºåæ°åº¦ï¼š

```rust
fn celsius_to_fahrenheit(celsius: f64) -> f64 {
    celsius * 9.0 / 5.0 + 32.0
}

fn main() {
    let temp_c = 25.0;
    let temp_f = celsius_to_fahrenheit(temp_c);
    
    println!("{}Â°C = {}Â°F", temp_c, temp_f);
}
```

### ç»ƒä¹ 2ï¼šæ•°ç»„æ“ä½œ

```rust
fn main() {
    let numbers = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10];
    
    // è®¡ç®—æ•°ç»„å…ƒç´ çš„å’Œ
    let mut sum = 0;
    for number in numbers.iter() {
        sum += number;
    }
    
    println!("æ•°ç»„å…ƒç´ çš„å’Œ: {}", sum);
    
    // æ‰¾å‡ºæœ€å¤§å€¼
    let mut max = numbers[0];
    for &number in numbers.iter() {
        if number > max {
            max = number;
        }
    }
    
    println!("æœ€å¤§å€¼: {}", max);
}
```

## å°ç»“

æœ¬ç« ä»‹ç»äº†Rustçš„å˜é‡ç³»ç»Ÿå’ŒåŸºæœ¬æ•°æ®ç±»å‹ï¼š

- å˜é‡é»˜è®¤ä¸å¯å˜ï¼Œä½¿ç”¨`mut`å…³é”®å­—åˆ›å»ºå¯å˜å˜é‡
- å˜é‡é®è”½å…è®¸é‡æ–°å®šä¹‰åŒåå˜é‡
- Rustæä¾›ä¸°å¯Œçš„åŸºæœ¬æ•°æ®ç±»å‹ï¼šæ•´æ•°ã€æµ®ç‚¹æ•°ã€å¸ƒå°”å€¼ã€å­—ç¬¦
- å¤åˆç±»å‹åŒ…æ‹¬å…ƒç»„å’Œæ•°ç»„
- ç±»å‹æ¨æ–­å‡å°‘äº†æ˜¾å¼ç±»å‹æ³¨è§£çš„éœ€è¦
- åœ¨åµŒå…¥å¼å¼€å‘ä¸­ï¼Œé€‰æ‹©åˆé€‚çš„æ•°æ®ç±»å‹å¯¹æ€§èƒ½å’Œå†…å­˜ä½¿ç”¨å¾ˆé‡è¦

æŒæ¡è¿™äº›åŸºç¡€çŸ¥è¯†åï¼Œä½ å°±å¯ä»¥å¼€å§‹å­¦ä¹ Rustçš„æ‰€æœ‰æƒç³»ç»Ÿäº†ã€‚

## ä¸‹ä¸€ç« 

[æ‰€æœ‰æƒç³»ç»Ÿ](./02-ownership.md) - å­¦ä¹ Rustæœ€ç‹¬ç‰¹å’Œé‡è¦çš„ç‰¹æ€§