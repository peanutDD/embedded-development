# ç¬¬2ç« ï¼šå¼€å‘ç¯å¢ƒæ­å»º

## æ¦‚è¿°

æœ¬ç« å°†æŒ‡å¯¼ä½ æ­å»ºå®Œæ•´çš„RuståµŒå…¥å¼å¼€å‘ç¯å¢ƒï¼ŒåŒ…æ‹¬å·¥å…·é“¾å®‰è£…ã€IDEé…ç½®ã€è°ƒè¯•ç¯å¢ƒè®¾ç½®ç­‰ã€‚æˆ‘ä»¬å°†æ”¯æŒå¤šç§æ“ä½œç³»ç»Ÿå’Œç¡¬ä»¶å¹³å°ï¼Œç¡®ä¿ä½ èƒ½å¤Ÿé¡ºåˆ©å¼€å§‹åµŒå…¥å¼å¼€å‘ä¹‹æ—…ã€‚

åµŒå…¥å¼å¼€å‘ç¯å¢ƒçš„æ­å»ºæ˜¯ä¸€ä¸ªå¤æ‚ä½†å…³é”®çš„è¿‡ç¨‹ï¼Œæ¶‰åŠäº¤å‰ç¼–è¯‘ã€ç¡¬ä»¶æŠ½è±¡ã€è°ƒè¯•æ¥å£ç­‰å¤šä¸ªæ–¹é¢ã€‚æœ¬ç« ä¸ä»…æä¾›è¯¦ç»†çš„å®‰è£…æŒ‡å¯¼ï¼Œè¿˜æ·±å…¥è§£é‡Šæ¯ä¸ªå·¥å…·çš„ä½œç”¨åŸç†å’Œæœ€ä½³å®è·µã€‚

## å­¦ä¹ ç›®æ ‡

- **å·¥å…·é“¾æŒæ¡**: å®‰è£…å’Œé…ç½®Rustå·¥å…·é“¾ï¼Œç†è§£äº¤å‰ç¼–è¯‘åŸç†
- **å¹³å°æ”¯æŒ**: è®¾ç½®å¤šç§åµŒå…¥å¼ç›®æ ‡æ¶æ„å’Œç¡¬ä»¶å¹³å°
- **è°ƒè¯•èƒ½åŠ›**: é…ç½®ä¸“ä¸šçš„è°ƒè¯•å’Œçƒ§å½•å·¥å…·é“¾
- **å¼€å‘æ•ˆç‡**: è®¾ç½®é«˜æ•ˆçš„IDEå’Œå¼€å‘ç¯å¢ƒ
- **è´¨é‡ä¿è¯**: å»ºç«‹è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒæŒç»­é›†æˆæµç¨‹
- **é—®é¢˜è§£å†³**: æŒæ¡ç¯å¢ƒè¯Šæ–­å’Œæ•…éšœæ’é™¤æŠ€èƒ½

## ç« èŠ‚å†…å®¹

### 2.1 åŸºç¡€ç¯å¢ƒå®‰è£… â­
- **Rustå·¥å…·é“¾**: rustupã€cargoã€rustcç‰ˆæœ¬ç®¡ç†
- **äº¤å‰ç¼–è¯‘**: ç›®æ ‡æ¶æ„ç†è§£ã€å·¥å…·é“¾é…ç½®
- **åŒ…ç®¡ç†**: Cargo.tomlé…ç½®ã€ä¾èµ–ç®¡ç†ç­–ç•¥
- **ç¯å¢ƒå˜é‡**: PATHã€RUST_TARGET_PATHç­‰å…³é”®é…ç½®
- **å®è·µé¡¹ç›®**: [basic_setup](projects/basic_setup/)

### 2.2 ç¡¬ä»¶å¹³å°é…ç½® â­
- **ARM Cortex-M**: STM32ã€nRFã€LPCç³»åˆ—æ”¯æŒ
- **RISC-V**: ESP32-C3ã€GD32VF103ç­‰å¹³å°
- **Xtensa**: ESP32ã€ESP8266æ¶æ„æ”¯æŒ
- **AVR**: Arduinoå…¼å®¹å¼€å‘æ¿é…ç½®
- **å¹³å°ç‰¹æ€§**: å†…å­˜æ˜ å°„ã€å¯åŠ¨ä»£ç ã€é“¾æ¥è„šæœ¬
- **å®è·µé¡¹ç›®**: [platform_configs](projects/platform_configs/)

### 2.3 è°ƒè¯•å·¥å…·å®‰è£… â­
- **probe-rs**: ç°ä»£åŒ–è°ƒè¯•å·¥å…·ï¼Œæ”¯æŒå¤šç§è°ƒè¯•å™¨
- **OpenOCD**: ä¼ ç»Ÿè°ƒè¯•å·¥å…·é…ç½®å’Œä½¿ç”¨
- **GDB**: å‘½ä»¤è¡Œè°ƒè¯•æŠ€å·§å’Œè„šæœ¬
- **RTT**: å®æ—¶ä¼ è¾“æŠ€æœ¯ï¼Œé«˜æ•ˆæ—¥å¿—è¾“å‡º
- **SWD/JTAG**: è°ƒè¯•æ¥å£åŸç†å’Œé…ç½®
- **å®è·µé¡¹ç›®**: [debug_setup](projects/debug_setup/)

### 2.4 IDEå’Œç¼–è¾‘å™¨é…ç½®
- **VS Code**: rust-analyzerã€è°ƒè¯•é…ç½®ã€ä»»åŠ¡è‡ªåŠ¨åŒ–
- **CLion**: Rustæ’ä»¶ã€CMakeé›†æˆã€è°ƒè¯•è®¾ç½®
- **Vim/Neovim**: LSPé…ç½®ã€æ’ä»¶ç”Ÿæ€ã€å·¥ä½œæµä¼˜åŒ–
- **ä»£ç è¡¥å…¨**: æ™ºèƒ½æç¤ºã€é”™è¯¯æ£€æŸ¥ã€é‡æ„æ”¯æŒ
- **å®è·µé¡¹ç›®**: [ide_configs](projects/ide_configs/)

### 2.5 é¡¹ç›®æ¨¡æ¿å’Œè„šæ‰‹æ¶
- **cargo-generate**: é¡¹ç›®æ¨¡æ¿åˆ›å»ºå’Œä½¿ç”¨
- **æ¨¡æ¿è®¾è®¡**: æœ€ä½³å®è·µæ¨¡æ¿ã€å¤šå¹³å°æ”¯æŒ
- **æ„å»ºç³»ç»Ÿ**: build.rsè„šæœ¬ã€æ¡ä»¶ç¼–è¯‘
- **é¡¹ç›®ç»“æ„**: æ¨¡å—ç»„ç»‡ã€æ–‡ä»¶å¸ƒå±€æ ‡å‡†
- **å®è·µé¡¹ç›®**: [project_templates](projects/project_templates/)

### 2.6 ä»¿çœŸå™¨å’Œæµ‹è¯•ç¯å¢ƒ
- **QEMUä»¿çœŸ**: ARMã€RISC-Vä»¿çœŸå™¨é…ç½®
- **å•å…ƒæµ‹è¯•**: stdç¯å¢ƒæµ‹è¯•ã€mockæŠ€æœ¯
- **é›†æˆæµ‹è¯•**: ç¡¬ä»¶åœ¨ç¯æµ‹è¯•ã€è‡ªåŠ¨åŒ–éªŒè¯
- **æ€§èƒ½æµ‹è¯•**: åŸºå‡†æµ‹è¯•ã€å†…å­˜ä½¿ç”¨åˆ†æ
- **å®è·µé¡¹ç›®**: [testing_setup](projects/testing_setup/)

### 2.7 æŒç»­é›†æˆé…ç½®
- **GitHub Actions**: å¤šå¹³å°æ„å»ºã€è‡ªåŠ¨åŒ–æµ‹è¯•
- **ä»£ç è´¨é‡**: clippyã€rustfmtã€å®‰å…¨å®¡è®¡
- **æ–‡æ¡£ç”Ÿæˆ**: rustdocã€mdbooké›†æˆ
- **å‘å¸ƒæµç¨‹**: ç‰ˆæœ¬ç®¡ç†ã€è‡ªåŠ¨å‘å¸ƒ
- **å®è·µé¡¹ç›®**: [ci_setup](projects/ci_setup/)

### 2.8 æ•…éšœæ’é™¤å’Œå¸¸è§é—®é¢˜
- **è¯Šæ–­å·¥å…·**: ç¯å¢ƒæ£€æŸ¥è„šæœ¬ã€é—®é¢˜å®šä½
- **å¸¸è§é”™è¯¯**: ç¼–è¯‘é”™è¯¯ã€é“¾æ¥é—®é¢˜ã€è°ƒè¯•å¤±è´¥
- **æ€§èƒ½ä¼˜åŒ–**: ç¼–è¯‘æ—¶é—´ã€äºŒè¿›åˆ¶å¤§å°ä¼˜åŒ–
- **ç¤¾åŒºèµ„æº**: å®˜æ–¹æ–‡æ¡£ã€ç¤¾åŒºæ”¯æŒã€é—®é¢˜æŠ¥å‘Š
- **å®è·µé¡¹ç›®**: [troubleshooting](projects/troubleshooting/)

## ç¯å¢ƒæ¶æ„å›¾

```mermaid
graph TB
    subgraph "å¼€å‘ä¸»æœº"
        A[Rustå·¥å…·é“¾] --> B[äº¤å‰ç¼–è¯‘å™¨]
        B --> C[ç›®æ ‡ä»£ç ]
        D[IDE/ç¼–è¾‘å™¨] --> E[ä»£ç ç¼–å†™]
        F[è°ƒè¯•å·¥å…·] --> G[probe-rs/OpenOCD]
    end
    
    subgraph "ç›®æ ‡ç¡¬ä»¶"
        H[å¾®æ§åˆ¶å™¨] --> I[è°ƒè¯•æ¥å£]
        I --> J[SWD/JTAG]
        H --> K[åº”ç”¨ç¨‹åº]
    end
    
    C --> |çƒ§å½•| K
    G --> |è°ƒè¯•è¿æ¥| J
    
    subgraph "æµ‹è¯•ç¯å¢ƒ"
        L[QEMUä»¿çœŸå™¨] --> M[è™šæ‹Ÿç¡¬ä»¶]
        N[å•å…ƒæµ‹è¯•] --> O[stdç¯å¢ƒ]
    end
    
    C --> |ä»¿çœŸè¿è¡Œ| M
```

## å·¥å…·é“¾ç‰ˆæœ¬çŸ©é˜µ

| å¹³å° | Rustç‰ˆæœ¬ | ç›®æ ‡æ¶æ„ | è°ƒè¯•å·¥å…· | æ¨èIDE |
|------|----------|----------|----------|----------|
| STM32F4 | 1.70+ | thumbv7em-none-eabihf | probe-rs | VS Code |
| ESP32 | 1.70+ | xtensa-esp32-none-elf | espflash | VS Code |
| nRF52 | 1.70+ | thumbv7em-none-eabihf | probe-rs | VS Code |
| RISC-V | 1.70+ | riscv32imac-unknown-none-elf | probe-rs | CLion |

## æ€§èƒ½åŸºå‡†

ä¸åŒé…ç½®ä¸‹çš„ç¼–è¯‘å’Œè°ƒè¯•æ€§èƒ½å¯¹æ¯”ï¼š

| é…ç½® | ç¼–è¯‘æ—¶é—´ | äºŒè¿›åˆ¶å¤§å° | è°ƒè¯•å»¶è¿Ÿ | å†…å­˜ä½¿ç”¨ |
|------|----------|------------|----------|----------|
| Debug | 15s | 128KB | <100ms | 512MB |
| Release | 45s | 32KB | <50ms | 256MB |
| LTO | 120s | 24KB | <50ms | 1GB |

## æœ€ä½³å®è·µ

### 1. å·¥å…·é“¾ç®¡ç†
```bash
# ä½¿ç”¨rustupç®¡ç†å¤šä¸ªå·¥å…·é“¾ç‰ˆæœ¬
rustup toolchain install stable
rustup toolchain install nightly
rustup default stable

# ä¸ºç‰¹å®šé¡¹ç›®è®¾ç½®å·¥å…·é“¾
rustup override set nightly
```

### 2. ç›®æ ‡æ¶æ„é…ç½®
```toml
# .cargo/config.toml
[build]
target = "thumbv7em-none-eabihf"

[target.thumbv7em-none-eabihf]
runner = "probe-rs run --chip STM32F411RETx"
rustflags = [
    "-C", "link-arg=-Tlink.x",
    "-C", "link-arg=--nmagic",
]
```

### 3. è°ƒè¯•é…ç½®ä¼˜åŒ–
```json
// .vscode/launch.json
{
    "version": "0.2.0",
    "configurations": [
        {
            "type": "probe-rs-debug",
            "request": "launch",
            "name": "Debug STM32",
            "chip": "STM32F411RETx",
            "flashingConfig": {
                "flashingEnabled": true,
                "resetAfterFlashing": true
            },
            "rttConfig": {
                "enabled": true,
                "up": [
                    {
                        "channel": 0,
                        "dataFormat": "String",
                        "showInTerminal": true
                    }
                ]
            }
        }
    ]
}
```

## å®‰å…¨è€ƒè™‘

### 1. å·¥å…·é“¾éªŒè¯
```bash
# éªŒè¯å·¥å…·é“¾å®Œæ•´æ€§
rustup check
cargo --version
probe-rs --version

# æ£€æŸ¥ç›®æ ‡æ¶æ„æ”¯æŒ
rustup target list --installed
```

### 2. ä¾èµ–å®‰å…¨
```toml
# Cargo.toml - å›ºå®šä¾èµ–ç‰ˆæœ¬
[dependencies]
cortex-m = "=0.7.7"
cortex-m-rt = "=0.7.3"
panic-halt = "=0.2.0"
```

### 3. æ„å»ºå®‰å…¨
```bash
# ä½¿ç”¨cargo-auditæ£€æŸ¥å®‰å…¨æ¼æ´
cargo install cargo-audit
cargo audit

# ä½¿ç”¨cargo-denyæ£€æŸ¥è®¸å¯è¯å’Œå®‰å…¨
cargo install cargo-deny
cargo deny check
```

## æ”¯æŒçš„æ“ä½œç³»ç»Ÿ

æœ¬æ•™ç¨‹æ”¯æŒä»¥ä¸‹æ“ä½œç³»ç»Ÿï¼š
- **macOS** (Intelå’ŒApple Silicon)
- **Linux** (Ubuntu, Debian, Fedora, Arch)
- **Windows** (Windows 10/11)

## ç¡¬ä»¶è¦æ±‚

### æœ€ä½è¦æ±‚
- CPU: åŒæ ¸å¤„ç†å™¨
- å†…å­˜: 4GB RAM
- å­˜å‚¨: 10GBå¯ç”¨ç©ºé—´
- USBç«¯å£: ç”¨äºè¿æ¥å¼€å‘æ¿

### æ¨èé…ç½®
- CPU: å››æ ¸æˆ–æ›´å¤š
- å†…å­˜: 8GB RAMæˆ–æ›´å¤š
- å­˜å‚¨: SSDï¼Œ20GBå¯ç”¨ç©ºé—´
- USBç«¯å£: USB 3.0æˆ–æ›´é«˜

## å¿«é€Ÿå¼€å§‹æ£€æŸ¥æ¸…å•

åœ¨å¼€å§‹ä¹‹å‰ï¼Œè¯·ç¡®ä¿ä½ æœ‰ä»¥ä¸‹ç‰©å“ï¼š

### è½¯ä»¶å‡†å¤‡
- [ ] æ“ä½œç³»ç»Ÿå·²æ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬
- [ ] å·²å®‰è£…Gitç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿ
- [ ] å…·æœ‰ç®¡ç†å‘˜æƒé™ï¼ˆç”¨äºå®‰è£…è½¯ä»¶ï¼‰
- [ ] ç¨³å®šçš„ç½‘ç»œè¿æ¥

### ç¡¬ä»¶å‡†å¤‡
- [ ] ç›®æ ‡å¼€å‘æ¿ï¼ˆSTM32, ESP32, Picoç­‰ï¼‰
- [ ] USBæ•°æ®çº¿
- [ ] è°ƒè¯•å™¨ï¼ˆST-Link, J-Linkç­‰ï¼Œå¯é€‰ï¼‰
- [ ] é¢åŒ…æ¿å’Œè·³çº¿ï¼ˆç”¨äºåŸå‹å¼€å‘ï¼‰

## å®‰è£…æ¦‚è§ˆ

æ•´ä¸ªç¯å¢ƒé…ç½®è¿‡ç¨‹å¤§è‡´åŒ…æ‹¬ä»¥ä¸‹æ­¥éª¤ï¼š

```mermaid
graph TD
    A[å®‰è£…Rust] --> B[æ·»åŠ ç›®æ ‡æ¶æ„]
    B --> C[å®‰è£…è°ƒè¯•å·¥å…·]
    C --> D[é…ç½®IDE]
    D --> E[åˆ›å»ºæµ‹è¯•é¡¹ç›®]
    E --> F[éªŒè¯ç¯å¢ƒ]
```

## ç¯å¢ƒéªŒè¯

å®Œæˆæ‰€æœ‰é…ç½®åï¼Œä½ åº”è¯¥èƒ½å¤Ÿï¼š

1. **ç¼–è¯‘åµŒå…¥å¼é¡¹ç›®**
```bash
cargo build --target thumbv7em-none-eabihf
```

2. **çƒ§å½•ç¨‹åºåˆ°ç¡¬ä»¶**
```bash
probe-rs run --chip STM32F411RETx target/thumbv7em-none-eabihf/debug/my-project
```

3. **å¯åŠ¨è°ƒè¯•ä¼šè¯**
```bash
probe-rs debug --chip STM32F411RETx target/thumbv7em-none-eabihf/debug/my-project
```

4. **æŸ¥çœ‹RTTè¾“å‡º**
```bash
probe-rs rtt --chip STM32F411RETx
```

## å¸¸ç”¨å‘½ä»¤é€ŸæŸ¥

### Rustå·¥å…·é“¾ç®¡ç†
```bash
# æŸ¥çœ‹å·²å®‰è£…çš„å·¥å…·é“¾
rustup show

# æ·»åŠ ç›®æ ‡æ¶æ„
rustup target add thumbv7em-none-eabihf

# æ›´æ–°å·¥å…·é“¾
rustup update
```

### Cargoå‘½ä»¤
```bash
# åˆ›å»ºæ–°é¡¹ç›®
cargo new --bin my-embedded-project

# æ„å»ºé¡¹ç›®
cargo build --target thumbv7em-none-eabihf

# æ£€æŸ¥ä»£ç 
cargo check --target thumbv7em-none-eabihf

# è¿è¡Œæµ‹è¯•
cargo test --target x86_64-unknown-linux-gnu
```

### probe-rså‘½ä»¤
```bash
# åˆ—å‡ºæ”¯æŒçš„èŠ¯ç‰‡
probe-rs chip list

# çƒ§å½•ç¨‹åº
probe-rs run --chip <CHIP_NAME> <ELF_FILE>

# å¯åŠ¨è°ƒè¯•
probe-rs debug --chip <CHIP_NAME> <ELF_FILE>

# RTTè¾“å‡º
probe-rs rtt --chip <CHIP_NAME>
```

## ç‰ˆæœ¬å…¼å®¹æ€§

æœ¬æ•™ç¨‹åŸºäºä»¥ä¸‹ç‰ˆæœ¬ç¼–å†™ï¼Œå»ºè®®ä½¿ç”¨ç›¸åŒæˆ–æ›´æ–°çš„ç‰ˆæœ¬ï¼š

| å·¥å…· | ç‰ˆæœ¬ | è¯´æ˜ |
|------|------|------|
| Rust | 1.70+ | ç¨³å®šç‰ˆ |
| probe-rs | 0.21+ | è°ƒè¯•å’Œçƒ§å½•å·¥å…· |
| cargo-generate | 0.18+ | é¡¹ç›®æ¨¡æ¿å·¥å…· |
| VS Code | 1.80+ | æ¨èç¼–è¾‘å™¨ |

## ç¤¾åŒºèµ„æº

- **å®˜æ–¹æ–‡æ¡£**: [The Embedded Rust Book](https://doc.rust-lang.org/embedded-book/)
- **ç¤¾åŒºè®ºå›**: [Rust Embedded Working Group](https://github.com/rust-embedded/wg)
- **MatrixèŠå¤©**: [#rust-embedded:matrix.org](https://matrix.to/#/#rust-embedded:matrix.org)
- **Awesomeåˆ—è¡¨**: [Awesome Embedded Rust](https://github.com/rust-embedded/awesome-embedded-rust)

## è·å–å¸®åŠ©

å¦‚æœåœ¨é…ç½®è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼š

1. **æŸ¥çœ‹æ•…éšœæ’é™¤æŒ‡å—**: [æ•…éšœæ’é™¤](./08-troubleshooting.md)
2. **æœç´¢å·²çŸ¥é—®é¢˜**: åœ¨GitHub issuesä¸­æœç´¢ç›¸å…³é—®é¢˜
3. **å¯»æ±‚ç¤¾åŒºå¸®åŠ©**: åœ¨MatrixèŠå¤©å®¤æˆ–è®ºå›æé—®
4. **æŸ¥çœ‹å®˜æ–¹æ–‡æ¡£**: å‚è€ƒæœ€æ–°çš„å®˜æ–¹æ–‡æ¡£

## ä¸‹ä¸€æ­¥

ç¯å¢ƒé…ç½®å®Œæˆåï¼Œå»ºè®®æŒ‰ä»¥ä¸‹é¡ºåºå­¦ä¹ ï¼š

1. å…ˆå®Œæˆä¸€ä¸ªç®€å•çš„"Hello World"é¡¹ç›®
2. å­¦ä¹ åŸºæœ¬çš„GPIOæ“ä½œ
3. å°è¯•ä¸²å£é€šä¿¡
4. æ¢ç´¢æ›´é«˜çº§çš„å¤–è®¾åŠŸèƒ½

---

**è®©æˆ‘ä»¬å¼€å§‹é…ç½®ä½ çš„RuståµŒå…¥å¼å¼€å‘ç¯å¢ƒå§ï¼** ğŸ› ï¸