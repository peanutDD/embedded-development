<?xml version="1.0" encoding="UTF-8"?>
<svg width="800" height="600" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      .wire { stroke: #000; stroke-width: 2; fill: none; }
      .component { stroke: #000; stroke-width: 2; fill: #fff; }
      .text { font-family: Arial, sans-serif; font-size: 12px; text-anchor: middle; }
      .label { font-family: Arial, sans-serif; font-size: 10px; text-anchor: middle; }
      .title { font-family: Arial, sans-serif; font-size: 16px; font-weight: bold; text-anchor: middle; }
      .mcu { fill: #e6f3ff; stroke: #0066cc; stroke-width: 2; }
      .led { fill: #ffcccc; stroke: #cc0000; stroke-width: 2; }
      .resistor { fill: #ffffcc; stroke: #cc6600; stroke-width: 2; }
      .mosfet { fill: #ccccff; stroke: #6600cc; stroke-width: 2; }
    </style>
  </defs>
  
  <!-- 标题 -->
  <text x="400" y="30" class="title">PWM呼吸灯控制电路</text>
  
  <!-- 微控制器 -->
  <rect x="50" y="100" width="120" height="200" class="mcu"/>
  <text x="110" y="120" class="text">STM32F4</text>
  <text x="110" y="135" class="text">微控制器</text>
  
  <!-- PWM输出引脚 -->
  <circle cx="170" cy="160" r="3" fill="#000"/>
  <text x="210" y="165" class="label">PA8 (TIM1_CH1)</text>
  
  <!-- VCC引脚 -->
  <circle cx="170" cy="200" r="3" fill="#000"/>
  <text x="190" y="205" class="label">3.3V</text>
  
  <!-- GND引脚 -->
  <circle cx="170" cy="250" r="3" fill="#000"/>
  <text x="190" y="255" class="label">GND</text>
  
  <!-- 基础PWM电路 (方案1) -->
  <text x="300" y="80" class="text">方案1: 直接PWM控制</text>
  
  <!-- 限流电阻 -->
  <rect x="280" y="150" width="60" height="20" class="resistor"/>
  <text x="310" y="165" class="text">330Ω</text>
  <text x="310" y="145" class="label">R1</text>
  
  <!-- LED -->
  <polygon points="380,150 400,160 380,170" class="led"/>
  <line x1="400" y1="150" x2="400" y2="170" stroke="#cc0000" stroke-width="2"/>
  <text x="390" y="145" class="label">D1</text>
  
  <!-- 基础电路连线 -->
  <line x1="170" y1="160" x2="280" y2="160" class="wire"/>
  <line x1="340" y1="160" x2="380" y2="160" class="wire"/>
  <line x1="400" y1="160" x2="430" y2="160" class="wire"/>
  <line x1="430" y1="160" x2="430" y2="250" class="wire"/>
  <line x1="170" y1="250" x2="430" y2="250" class="wire"/>
  
  <!-- MOSFET驱动电路 (方案2) -->
  <text x="550" y="80" class="text">方案2: MOSFET驱动 (大功率LED)</text>
  
  <!-- MOSFET -->
  <rect x="520" y="140" width="30" height="40" class="mosfet"/>
  <text x="535" y="135" class="label">Q1</text>
  <text x="535" y="190" class="text">N-MOSFET</text>
  <text x="535" y="205" class="label">(2N7002)</text>
  
  <!-- 栅极电阻 -->
  <rect x="450" y="150" width="40" height="20" class="resistor"/>
  <text x="470" y="165" class="text">1kΩ</text>
  <text x="470" y="145" class="label">R2</text>
  
  <!-- 大功率LED -->
  <polygon points="580,120 600,130 580,140" class="led"/>
  <line x1="600" y1="120" x2="600" y2="140" stroke="#cc0000" stroke-width="3"/>
  <text x="590" y="115" class="label">D2</text>
  <text x="590" y="155" class="text">大功率LED</text>
  
  <!-- 限流电阻 (大功率) -->
  <rect x="620" y="120" width="40" height="20" class="resistor"/>
  <text x="640" y="135" class="text">10Ω</text>
  <text x="640" y="115" class="label">R3</text>
  
  <!-- MOSFET电路连线 -->
  <line x1="170" y1="160" x2="450" y2="160" class="wire"/>
  <line x1="490" y1="160" x2="520" y2="160" class="wire"/>
  <line x1="535" y1="140" x2="535" y2="130" class="wire"/>
  <line x1="535" y1="130" x2="580" y2="130" class="wire"/>
  <line x1="600" y1="130" x2="620" y2="130" class="wire"/>
  <line x1="660" y1="130" x2="680" y2="130" class="wire"/>
  <line x1="680" y1="130" x2="680" y2="90" class="wire"/>
  <line x1="680" y1="90" x2="170" y2="90" class="wire"/>
  <line x1="170" y1="90" x2="170" y2="200" class="wire"/>
  
  <!-- MOSFET源极到GND -->
  <line x1="535" y1="180" x2="535" y2="250" class="wire"/>
  
  <!-- PWM波形图 -->
  <rect x="50" y="350" width="300" height="150" stroke="#000" stroke-width="1" fill="#f8f8f8"/>
  <text x="200" y="370" class="text">PWM波形与亮度关系</text>
  
  <!-- PWM波形 -->
  <polyline points="70,400 90,400 90,380 110,380 110,400 130,400 130,380 150,380 150,400 170,400 170,380 190,380 190,400 210,400" 
            stroke="#0066cc" stroke-width="2" fill="none"/>
  <text x="140" y="420" class="label">PWM信号 (50%占空比)</text>
  
  <!-- 亮度曲线 -->
  <polyline points="70,450 100,440 130,420 160,400 190,380 220,360 250,340 280,320 310,300" 
            stroke="#cc0000" stroke-width="2" fill="none"/>
  <text x="190" y="480" class="label">LED亮度变化曲线</text>
  
  <!-- 参数说明 -->
  <text x="400" y="350" class="text">PWM参数配置：</text>
  <text x="400" y="370" class="label">• 频率: 1kHz - 20kHz (避免闪烁)</text>
  <text x="400" y="385" class="label">• 占空比: 0% - 100% (控制亮度)</text>
  <text x="400" y="400" class="label">• 分辨率: 8位 (256级亮度)</text>
  <text x="400" y="415" class="label">• 定时器: TIM1/TIM2/TIM3等</text>
  
  <text x="400" y="450" class="text">呼吸效果实现：</text>
  <text x="400" y="470" class="label">• 正弦波调制占空比</text>
  <text x="400" y="485" class="label">• 渐变周期: 2-5秒</text>
  <text x="400" y="500" class="label">• 非线性亮度补偿</text>
  <text x="400" y="515" class="label">• 平滑过渡算法</text>
  
  <!-- 电路对比 -->
  <text x="600" y="350" class="text">电路对比：</text>
  <text x="600" y="370" class="label">方案1 - 直接驱动:</text>
  <text x="600" y="385" class="label">• 简单，成本低</text>
  <text x="600" y="400" class="label">• 适合小功率LED</text>
  <text x="600" y="415" class="label">• GPIO电流限制20mA</text>
  
  <text x="600" y="440" class="label">方案2 - MOSFET驱动:</text>
  <text x="600" y="455" class="label">• 可驱动大功率LED</text>
  <text x="600" y="470" class="label">• 电流可达数安培</text>
  <text x="600" y="485" class="label">• 需要额外元件</text>
  <text x="600" y="500" class="label">• 更好的散热设计</text>
</svg>